
<form [formGroup]="movieForm">
  <div class="modal-header">
    <span class="validation-alert-title" *ngIf="title.errors?.required">
        Title is required
    </span>
    <span class="validation-alert-title process" *ngIf="title.status==='PENDING'">
        Checking...
    </span>
    <span class="validation-alert-title success" *ngIf="title.status==='VALID'&&title.value!==movie.title">
        Title is available
    </span>
    <span class="validation-alert-title" *ngIf="title.errors?.titleExist&&title.value!==movie.title">
        Title already exists
    </span>
    <input formControlName="title"
           type="text" 
           class="form-control form-control-lg mt-3" 
           id="titleInput" 
           value="{{movie.title | capitalizeFirstLetter | removeNonEnglishLetter}}"
           [ngStyle]="{'border-color':title.valid||title.value===movie.title ? '#ced4da' : 'red' }"> 
  </div>
  <div class="modal-body row">
    <div class="container">
      <div class="row">
    <!-- Image -->
    <div class="col-auto">
      <img class="card-img-top" src="{{movie.poster}}" alt="Card image cap">
    </div>

    <!-- Id -->
    <div class="col-8">
        <div class="form-group row">
          <label for="idFormInput" 
                 class="col-sm-2 col-form-label">Id</label>
          <div class="col-sm-10">
           
            <input formControlName="id"
                   type="text" 
                   class="form-control" 
                   id="idFormInput" 
                   value="{{movie.id}}"
                   disabled>
          </div>
      </div>
        <!-- Year -->
        <div class="form-group row mt-4">
            <label for="yearFormInput" class="col-sm-2 col-form-label">Year</label>
            <div class="col-sm-10">
              <span class="validation-alert" *ngIf="year.errors?.required">
                  Year is required
              </span>
              <span class="validation-alert" *ngIf="year.errors?.min">
                  Year must be greater than or equals {{yearMinValue}}
              </span>
              <span class="validation-alert" *ngIf="year.errors?.max">
                  Year must be less than or equal to {{yearMaxValue}}
              </span>
              <input formControlName="year"
                     type="number" 
                     class="form-control" 
                     id="yearFormInput" 
                     value="{{movie.year}}"
                     [ngStyle]="{'border-color':year.invalid ? 'red' : '#ced4da' }">
            </div>
        </div>
        <!-- Runtime -->
        <div class="form-group row mt-4">
            <label for="runtimeFormInput" 
                   class="col-sm-2 col-form-label">Runtime</label>
            <div class="col-sm-10">
              <div class="input-group mb-3">
                  <span class="validation-alert" *ngIf="runtime.errors?.required">
                      Runtime is required
                  </span>
                  <span class="validation-alert" *ngIf="runtime.errors?.min">
                      Year must be greater than or equals {{runtimeMinValue}}
                  </span>
                  <span class="validation-alert" *ngIf="runtime.errors?.max">
                      Year must be greater than or equals {{runtimeMaxValue}}
                  </span>
                <input formControlName="runtime"
                                   type="number" 
                                   class="form-control" 
                                   id="runtimeFormInput" 
                                   value="{{movie.runtime | runtimeToNumber}}"
                                   [ngStyle]="{'border-color':runtime.invalid ? 'red' : '#ced4da' }">
                <div class="input-group-append">
                  <span class="input-group-text" 
                        id="basic-addon2">minutes</span>
                </div>
              </div>
            </div>
        </div>
          <!-- Genre -->
          <div class="form-group row">
              <label for="genreFormInput" 
                     class="col-sm-2 col-form-label">Genre</label>
              <div class="col-sm-10">
                <span class="validation-alert" *ngIf="genre.errors?.required">
                    Genre is required
                </span>
                <input formControlName="genre"
                       type="text"
                       class="form-control" 
                       id="genreFormInput" 
                       value="{{movie.genre}}"
                       [ngStyle]="{'border-color':genre.invalid ? 'red' : '#ced4da' }">
              </div>
          </div>
          <!-- Director -->
          <div class="form-group row mt-4">
              <label for="directorFormInput" class="col-sm-2 col-form-label">Director</label>
              <div class="col-sm-10">
                <span class="validation-alert" *ngIf="director.errors?.required">
                    Director is required
                </span>
                <textarea  formControlName="director"
                           type="text"
                           class="form-control" 
                           id="directorFormInput" 
                           value="{{movie.director}}"
                           [ngStyle]="{'border-color':director.invalid ? 'red' : '#ced4da' }"></textarea>
              </div>
          </div>


    </div> 
      </div>
      <div class="row ">
        <div class="col">
   <!-- Image Url -->
   <div class="form-group row mt-3">
      <label for="posterFormInput" class="col-sm-2 col-form-label">Image Url</label>
      <div class="col-sm-10">
          <span class="validation-alert" *ngIf="poster.errors?.required">
              Image Url is required
          </span>
        <textarea  formControlName="poster"
                   type="text"
                   class="form-control" 
                   id="posterFormInput" 
                   value="{{movie.poster | localImageUrlHider}}"
                   (keyup)="setMovieImage(poster.value)"
                   [ngStyle]="{'border-color':poster.invalid ? 'red' : '#ced4da' }"></textarea>
      </div>
  </div>
        </div>
  
      </div>
    </div>
   
  </div>
  <div class="modal-footer">
    <div class="row container-fluid text-center">
      
        <button type="button" 
                class="col-4 btn btn-outline-danger" 
                appButtonHover
                (click)="deleteConfirmation()">Delete</button>
     
            
              <button type="button" 
                      class="col-4 btn btn-outline-success" 
                      [disabled]="!movieForm.valid"
                      appButtonHover
                      (click)="updateMovie()">Save</button>
            
      
          <button type="button" 
                  class="col-4 btn btn-outline-dark" 
                  appButtonHover
                  (click)="activeModal.close('Close click')">Close</button>
      
    </div>
  </div>
</form>

